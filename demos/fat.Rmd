# Data Set for Body Fat Prediction

http://lib.stat.cmu.edu/datasets/bodyfat

```{r}
load('fat.rda')

mod.lm <- lm(body.fat ~ age + weight + height, data = fat)
mod.glm <- glm(body.fat ~ age + weight + height, data = fat, family = gaussian)

par(mfrow = c(2, 2))
plot(mod.lm)

```

# Confidence curve for the expected BFP of a 170lb, 6ft, 20-year old male

```{r}
x <- c(1,    # Intercept
       20,   # 20 years old
       170,  # 170 lbs
       6*12) # 72 inches (6 feet)

library(clp)

conf.out.lm <- lm.lincom.conf(mod.lm, x)

conf.out.glm <- glm.lincom.conf.disp(mod.glm, x)
```

## Compare exact cc from Gaussian noise to GLM cc

```{r}
curve(conf.out.lm$cconf(x), from = 9, to = 14, n = 2001, col = 'blue')
curve(conf.out.glm$cconf(x), from = 9, to = 14, n = 2001, col = 'red', lty = 3, add = TRUE)
```

```{r}
resp <- seq(9, 14, length.out = 2000)

plot(resp, conf.out.lm$cc(resp) - conf.out.glm$cc(resp))

curve(0.01*(conf.out.lm$cc(x)-1), add = TRUE)
```

